<?php
// $Id$

/**
* Implementation of hook_menu().
*/
function citybudget_js_menu() {
  $items['example'] = array(
    'title' => 'Program Operating Budgets',
    'page callback' => 'citybudget_js_page',
    'access arguments' => array('access content'),
  );
  return $items;
}

function citybudget_js_page() {
  drupal_add_js(libraries_get_path('jit') . '/jit-yc.js');/*
  drupal_add_js(<<<ASDF
$(document).ready(function () {
  var treemap = {"id":"ID","name":"Name","children":[{"children":[],"data":{"\$area":23387.599915981},"id":"311 Customer Service Strategy","name":"311 Customer Service Strategy"},{"children":[],"data":{"\$area":5113.7001214027},"id":"Affordable Housing Office","name":"Affordable Housing Office"},{"children":[],"data":{"\$area":672234.20306396},"id":"Children's Services","name":"Children's Services"},{"children":[],"data":{"\$area":107573.09837341},"id":"Court Services","name":"Court Services"},{"children":[],"data":{"\$area":46361.900970459},"id":"Economic Development and Culture","name":"Economic Development and Culture"},{"children":[],"data":{"\$area":258063.80058861},"id":"Emergency Medical Services","name":"Emergency Medical Services"},{"children":[],"data":{"\$area":386982.19644165},"id":"Long-Term Care Homes & Services","name":"Long-Term Care Homes & Services"},{"children":[],"data":{"\$area":431497.30632019},"id":"Parks, Forestry & Recreation","name":"Parks, Forestry & Recreation"},{"children":[],"data":{"\$area":2089635.7025757},"id":"Toronto Employment and Social Services","name":"Toronto Employment and Social Services"},{"children":[],"data":{"\$area":1583473.6241827},"id":"Shelter, Support and Housing Administration","name":"Shelter, Support and Housing Administration"},{"children":[],"data":{"\$area":36563.200645447},"id":"Social Development, Finance and Administration","name":"Social Development, Finance and Administration"},{"children":[],"data":{"\$area":12535.200163841},"id":"Arena Boards of Management","name":"Arena Boards of Management"},{"children":[],"data":{"\$area":7343.500193119},"id":"Association of Community Centres","name":"Association of Community Centres"},{"children":[],"data":{"\$area":119503.19638062},"id":"Exhibition Place","name":"Exhibition Place"},{"children":[],"data":{"\$area":1043},"id":"Heritage Toronto","name":"Heritage Toronto"},{"children":[],"data":{"\$area":191437.70778751},"id":"Toronto Public Library","name":"Toronto Public Library"},{"children":[],"data":{"\$area":2301.1999874115},"id":"Toronto Police Services Board","name":"Toronto Police Services Board"},{"children":[],"data":{"\$area":4392},"id":"Toronto Atmospheric Fund","name":"Toronto Atmospheric Fund"},{"children":[],"data":{"\$area":76808.898803711},"id":"Toronto Zoo","name":"Toronto Zoo"},{"children":[],"data":{"\$area":2664.5999939442},"id":"Yonge-Dundas Square","name":"Yonge-Dundas Square"},{"children":[],"data":{"\$area":2202674.8945312},"id":"Toronto Transit Commission","name":"Toronto Transit Commission"},{"children":[],"data":{"\$area":83996.799377441},"id":"Wheel-Trans","name":"Wheel-Trans"},{"children":[],"data":{"\$area":75424.600463867},"id":"Toronto and Region Conservation Authority","name":"Toronto and Region Conservation Authority"},{"children":[],"data":{"\$area":401932.99715567},"id":"Toronto Public Health","name":"Toronto Public Health"},{"children":[],"data":{"\$area":185868.80224609},"id":"Toronto Parking Authority","name":"Toronto Parking Authority"},{"children":[],"data":{"\$area":9076.8000183105},"id":"Toronto Centre for the Arts","name":"Toronto Centre for the Arts"},{"children":[],"data":{"\$area":103116.79986572},"id":"Toronto Building","name":"Toronto Building"},{"children":[],"data":{"\$area":374959.79449463},"id":"Fire Services","name":"Fire Services"},{"children":[],"data":{"\$area":80838.199874878},"id":"Municipal Licensing and Standards","name":"Municipal Licensing and Standards"},{"children":[],"data":{"\$area":61351.100826263},"id":"City Planning","name":"City Planning"},{"children":[],"data":{"\$area":37781.500518799},"id":"Policy, Planning, Finance and Administration","name":"Policy, Planning, Finance and Administration"},{"children":[],"data":{"\$area":2163.9000121951},"id":"Waterfront Secretariat","name":"Waterfront Secretariat"},{"children":[],"data":{"\$area":1397406.7827637},"id":"Toronto Water","name":"Toronto Water"},{"children":[],"data":{"\$area":381418.6940918},"id":"Transportation Services","name":"Transportation Services"},{"children":[],"data":{"\$area":16179.199908257},"id":"Toronto Environment Office","name":"Toronto Environment Office"},{"children":[],"data":{"\$area":114166.40249024},"id":"Technical Services","name":"Technical Services"},{"children":[],"data":{"\$area":637973.40515137},"id":"Solid Waste Management Services","name":"Solid Waste Management Services"},{"children":[],"data":{"\$area":46753.899230957},"id":"Community Partnership and Investment Program","name":"Community Partnership and Investment Program"},{"children":[],"data":{"\$area":2364.100001812},"id":"Accountability Offices","name":"Accountability Offices"},{"children":[],"data":{"\$area":4381.6000728607},"id":"Auditor General's Office","name":"Auditor General's Office"},{"children":[],"data":{"\$area":16489.59998703},"id":"Office of the Chief Financial Officer","name":"Office of the Chief Financial Officer"},{"children":[],"data":{"\$area":93205.200200081},"id":"Fleet Services","name":"Fleet Services"},{"children":[],"data":{"\$area":274820.80178261},"id":"Facilities and Real Estate","name":"Facilities and Real Estate"},{"children":[],"data":{"\$area":96261.600440979},"id":"Information & Technology","name":"Information & Technology"},{"children":[],"data":{"\$area":116246.30220032},"id":"Office of the Treasurer","name":"Office of the Treasurer"},{"children":[],"data":{"\$area":130022.20019531},"id":"Parking Tag Enforcement & Operations","name":"Parking Tag Enforcement & Operations"},{"children":[],"data":{"\$area":71097.800292969},"id":"City Clerk's Office","name":"City Clerk's Office"},{"children":[],"data":{"\$area":19451.500183105},"id":"City Council","name":"City Council"},{"children":[],"data":{"\$area":58952.001060486},"id":"Legal Services","name":"Legal Services"},{"children":[],"data":{"\$area":44254.700174332},"id":"City Manager's Office","name":"City Manager's Office"},{"children":[],"data":{"\$area":2603.6999573708},"id":"The Office of the Mayor","name":"The Office of the Mayor"}]};
  var tm = new \$jit.TM.Squarified({
    injectInto: "citybudget-js-treemap",
    animate: true,
  });
  tm.loadJSON(treemap);
  tm.refresh();
});
ASDF
, 'inline');*/
  drupal_add_js(drupal_get_path('module', 'citybudget_js') . '/js/citybudget_js.js');
  //drupal_add_js(drupal_get_path('module', 'citybudget_js') . '/js/test.js');
  return '<div id="citybudget-js-treemap" style="height:600px;width=800px;"></div><div id="citybudget-js"></div>';
}

/**
 * Implementation of hook_default_services_endpoint().
 */
function citybudget_js_default_services_endpoint() {
  $endpoints = array();

  $endpoint = new stdClass;
  $endpoint->disabled = FALSE; /* Edit this to true to make a default endpoint disabled initially */
  $endpoint->api_version = 3;
  $endpoint->name = 'citybudget';
  $endpoint->title = 'City Budget API';
  $endpoint->server = 'rest_server';
  $endpoint->path = 'api';
  $endpoint->authentication = array();
  $endpoint->resources = array(
    'citybudget' => array(
      'alias' => '',
      'operations' => array(
        'retrieve' => array(
          'enabled' => 1,
        ),
        'index' => array(
          'enabled' => 1,
        ),
      ),
    ),
  );

  $endpoints[] = $endpoint;

  return $endpoints;
}